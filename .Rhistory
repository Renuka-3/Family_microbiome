library(ggplot2)
library(phyloseq)
library(phyloseq)
library(dada2)
library(readxl)
library(dada2)
library(readxl)
library(dplyr)
otu_mat<- read_excel("inputdata/processed/tables/OTU_table.xlsx")
tax_mat<- read_excel("inputdata/processed/tables/Taxa_table.xlsx")
samples_df <- read_excel("inputdata/processed/tables/Metadata.xlsx")
row.names(otu_mat) <- otu_mat$OTUU
otu_mat <- otu_mat %>% select (-OTUU)
row.names(tax_mat) <- tax_mat$OTUU
tax_mat <- tax_mat %>% select (-OTUU)
row.names(samples_df) <- samples_df$Sample
otu_mat <- as.matrix(otu_mat)
tax_mat <- as.matrix(tax_mat)
OTU = otu_table(otu_mat, taxa_are_rows = TRUE)
TAX = tax_table(tax_mat)
sam = sample_data(as.data.frame(samples_df))
phyloseq <- phyloseq(OTU, TAX, sam)
saveRDS(phyloseq, file = "inputdata/processed/phyloseq/phyloseq.RDS")
library(microbiome)
library(phyloseq)
library(vegan)
library(Cairo)
install.packages("cairo")
library(Cairo)
BiocManager::install("cairo")
library(Cairo)
library(knitr)
library(knitcitations)
install.packages("knitcitation")
library(knitcitations)
library("cairo")
library(microbiome)
library(ggplot2)
library(dplyr)
library(vegan)
library(reshape2)
library(DESeq2)
opts_chunk$set(dev="CairoPNG")
knitr::opts_chunk$set(fig.path="output/figure_pcoa/")
BiocManager::install(DESeq2)
BiocManager::install("DESeq2")
library(DESeq2)
opts_chunk$set(dev="CairoPNG")
knitr::opts_chunk$set(fig.path="output/figure_pcoa/")
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
phylo <- readRDS(""inputdata/processed/phyloseq/phyloseq.RDS"")
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS)
theme_set(theme_bw(15))
p <- plot_landscape(microbiome::transform(phylo , "compositional"),
p <- plot_landscape(microbiome::transform(phylo , "compositional"),
distance = distance,
method = method,
size = 3,
col = "Diet",
shading = FALSE) +
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom')
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS)
p <- plot_landscape(microbiome::transform(phylo, "compositional"),
p <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 3,
col = "Diet",
shading = FALSE)
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS)
phyloseq
phylo
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS)
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS")
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS")
p <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 3,
col = "Diet",
shading = FALSE)
print(p)
```{r pcoa, echo=FALSE, message=FALSE, fig.width=25, fig.height=20, out.width="30", fig.show="hold", warning=FALSE}
theme_set(theme_bw(20))
p <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom')
print(p)
```{r pcoa, echo=FALSE, message=FALSE, fig.width=25, fig.height=30, out.width="30", fig.show="hold", warning=FALSE}
theme_set(theme_bw(30))
p <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom')
print(p)
```{r pcoa, echo=FALSE, message=FALSE, fig.width=25, fig.height=30, out.width="30", fig.show="hold", warning=FALSE}
```{r PCoA, echo=FALSE, message=FALSE, fig.width=25, fig.height=30, out.width="30", fig.show="hold", warning=FALSE}
theme_set(theme_bw(30))
p <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom')
print(p)
```{r PCoA, echo=FALSE, message=FALSE, fig.width=25, fig.height=30, fig.show="hold", warning=FALSE}
```{r PCoA, echo=FALSE, message=FALSE, fig.width=25, fig.height=30, fig.show="hold", warning=FALSE}
theme_set(theme_bw(30))
p <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom')
print(p)
knitr::opts_chunk$set(fig.path="output/figure_pcoa/")
Sys.setenv(LC_COLLATE = "C", LANGUAGE = "en")
library("tools")
testInstalledBasic("both")
testInstalledPackages(scope = "base", errorsAreFatal = FALSE)
testInstalledPackages(scope = "recommended", errorsAreFatal = FALSE)
library(cairo)
install.packages('Cairo')
library(Cairo)
library(cairo)
library(cairo)
library(cairo)
library(DESeq2)
opts_chunk$set(dev="CairoPNG")
knitr::opts_chunk$set(fig.path="output/figure_pcoa/")
library(cairo)
library(Cairo)
library(cairo)
library(microbiome)
library(phyloseq)
library(vegan)
library(knitr)
library(microbiome)
library(ggplot2)
library(dplyr)
library(vegan)
library(reshape2)
library(DESeq2)
library(cairo)
stop(packageNotFoundError(package, lib.loc, sys.call()))
library(cairo)
stop(packageNotFoundError(package, lib.loc, sys.call()))
capabilities()
installed.packages(libpixman-1-dev)
libpixman-1-dev
installed.packages("libpixman-1-dev")
apt-get install libcairo2-dev
install.packages('Cairo')
library(Cairo)
install.packages("Cairo")
library(Cairo)
opts_chunk$set(dev="CairoPNG")
library(knitr)
library(microbiome)
library(ggplot2)
library(dplyr)
library(reshape2)
library(DESeq2)
library(DESeq2)
library(Cairo)
opts_chunk$set(dev="CairoPNG")
knitr::opts_chunk$set(fig.path="output/figure_pcoa/")
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS")
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS")
## *Principal Coordinates Analysis (PCoA)*
* Ordination method: `r method`
* Dissimilarity measure: `r distance`
```{r PCoA, echo=FALSE, message=FALSE, fig.width=25, fig.height=30, fig.show="hold", warning=FALSE}
theme_set(theme_bw(30))
p <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom')
print(p)
library(knitcitations)
install.packages(knitcitations)
install.packages("knitcitations")
library(knitcitations)
library(knitcitations)
library(microbiome)
library(ggplot2)
library(dplyr)
library(reshape2)
library(DESeq2)
library(Cairo)
opts_chunk$set(dev="CairoPNG")
knitr::opts_chunk$set(fig.path="output/figure_pcoa/")
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS")
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS")
## *Principal Coordinates Analysis (PCoA)*
* Ordination method: `r method`
* Dissimilarity measure: `r distance`
```{r PCoA, echo=FALSE, message=FALSE, fig.width=25, fig.height=30, fig.show="hold", warning=FALSE}
theme_set(theme_bw(30))
p <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom')
print(p)
p <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25)))
p <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
print(p)
```{r PCoA, echo=FALSE, message=FALSE, fig.width=25, fig.height=30, fig.show="hold", warning=FALSE}
knitr::opts_chunk$set(fig.path="output/figure_pcoa/", echo = TRUE)
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS")
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS")
## *Principal Coordinates Analysis (PCoA)*
* Ordination method: `r method`
* Dissimilarity measure: `r distance`
```{r PCoA, echo=FALSE, message=FALSE, fig.width=25, fig.height=30, fig.show="hold", warning=FALSE}
theme_set(theme_bw(30))
```{r PCoA, echo=TRUE, message=FALSE, fig.width=25, fig.height=30, fig.show="hold", warning=FALSE}
theme_set(theme_bw(30))
p1 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p2 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Age",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Age") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p3 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Gender",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Gender") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p4 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Location",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Location") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p5 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Family",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Family") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
gridExtra::grid.arrange(p, p1, p2, p3, p4, p5, nrow = 2)
install.packages('gridExtra')
library(gridExtra)
theme_set(theme_bw(30))
p1 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p2 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Age",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Age") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p3 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Gender",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Gender") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p4 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Location",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Location") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p5 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Family",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Family") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
gridExtra::grid.arrange(p, p1, p2, p3, p4, p5, nrow = 2)
library(microbiome)
library(phyloseq)
library(vegan)
library(knitr)
library(knitcitations)
library(microbiome)
library(ggplot2)
library(dplyr)
library(reshape2)
library(DESeq2)
library(Cairo)
library(gridExtra)
opts_chunk$set(dev="CairoPNG")
knitr::opts_chunk$set(fig.path="output/figure_pcoa/")
method <- "PCoA"
trans <- "compositional"
distance <- "bray"
phylo <- readRDS("inputdata/processed/phyloseq/phyloseq.RDS")
theme_set(theme_bw(30))
p1 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p2 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Age",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Age") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p3 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Gender",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Gender") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p4 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Location",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Location") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p5 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Family",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Family") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
gridExtra::grid.arrange(p, p1, p2, p3, p4, p5, nrow = 2)
theme_set(theme_bw(30))
p1 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Diet",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Diet") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p2 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Age",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Age") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p3 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Gender",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Gender") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p4 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Location",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Location") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
p5 <- plot_landscape(microbiome::transform(phylo, "compositional"),
distance = distance,
method = method,
size = 5,
col = "Family",
shading = FALSE)+
scale_colour_brewer(palette = "Set1")	+ labs(title = "Family") + theme(legend.position = 'bottom', legend.text=element_text(size=20), legend.title=element_text(size=25))
gridExtra::grid.arrange(p1, p2, p3, p4, p5, nrow = 2)
knit(PCoA, output = "code/work/PCoA.md")
knit(PCoA.Rmd, output = "code/work/PCoA.md")
knit(PCoA, output = "code/work/PCoA.md")
knit(PCoA, output = "code/work/PCoA.md")
knit(input = PCoA, output = "code/work/PCoA.md")
knit(input = "PCoA.Rmd", output = "code/work/PCoA.md")
